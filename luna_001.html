<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabella Culminazione Luna</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

<h1>Tabella Mensile Culminazione della Luna 13:04</h1>
<table>
    <thead>
        <tr>
            <th>Data</th>
            <th>Ora di Culminazione (UTC)</th>
        </tr>
    </thead>
    <tbody id="moonCulminationTable"></tbody>
</table>

<script>
    // Funzione per calcolare l'ora siderale di Greenwich (GST)
    function calculateGST(julianDate) {
        return 280.46061837 + 360.98564736629 * (julianDate - 2451545);
    }

    // Funzione per calcolare l'ora siderale locale (LST)
    function calculateLST(gst, observerLongitude, observerOffset) {
        let lst = gst + (observerLongitude / 15.0) + observerOffset;
        return lst % 24; // Mantieni l'ora tra 0 e 24 ore
    }

    // Funzione per calcolare la posizione della Luna
    function calculateMoonPosition(julianDate) {
        // Approssimazione delle coordinate lunari
        let AR = 4.4; // Ascensione retta (esempio)
        let Decl = -23.5; // Declinazione (esempio)
        return { AR, Decl };
    }

    // Funzione per calcolare la culminazione
    function calculateMoonCulmination(observerLatitude, observerLongitude, julianDate, observerOffset) {
        const gst = calculateGST(julianDate);
        const lst = calculateLST(gst, observerLongitude, observerOffset);

        // Calcolare la posizione della Luna
        const { AR, Decl } = calculateMoonPosition(julianDate);

        // Determinare la culminazione
        let culminationTime = lst - AR;
        if (culminationTime < 0) {
            culminationTime += 24; // Se il tempo Ã¨ negativo, aggiungi 24 ore
        }

        return culminationTime;
    }

    // Funzione per calcolare il giorno giuliano
    function calculateJulianDate(year, month, day) {
        const a = Math.floor((14 - month) / 12);
        const y = year + 4800 - a;
        const m = month + 12 * a - 3;
        const jd = day + Math.floor((153 * m + 2) / 5) + 365 * y + Math.floor(y / 4) - Math.floor(y / 100) + Math.floor(y / 400) - 32045;
        return jd;
    }

    // Funzione per generare la tabella della culminazione lunare
    function generateMoonCulminationTable() {
        const observerLatitude = 45.45; // Esempio: latitudine dell'Italia
        const observerLongitude = 9.19; // Esempio: longitudine dell'Italia
        const observerOffset = 1; // Fuso orario (UTC+1)

        const year = 2025;
        const month = 2; // Esempio: Febbraio

        const daysInMonth = new Date(year, month, 0).getDate();

        let tableBody = '';

        for (let day = 1; day <= daysInMonth; day++) {
            const julianDate = calculateJulianDate(year, month, day);
            const culminationTime = calculateMoonCulmination(observerLatitude, observerLongitude, julianDate, observerOffset);

            // Converti il tempo della culminazione in ore e minuti
            const hours = Math.floor(culminationTime);
            const minutes = Math.round((culminationTime - hours) * 60);
            const culminationString = `${hours}:${minutes < 10 ? '0' : ''}${minutes} UTC`;

            tableBody += `<tr><td>${year}-${month}-${day}</td><td>${culminationString}</td></tr>`;
        }

        document.getElementById('moonCulminationTable').innerHTML = tableBody;
    }

    // Genera la tabella al caricamento della pagina
    window.onload = function() {
        generateMoonCulminationTable();
    };
</script>

</body>
</html>
