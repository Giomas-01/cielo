<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcolo Ora Culminazione della Luna</title>
</head>
<body>
    <h1>Calcolo dell'Ora di Culminazione della Luna (15:15)</h1>
    <form id="culminationForm">
        <label for="year">Anno:</label>
        <input type="number" id="year" name="year" value="2025" min="1900" max="2100">
        <label for="month">Mese:</label>
        <input type="number" id="month" name="month" value="2" min="1" max="12">
        <label for="day">Giorno:</label>
        <input type="number" id="day" name="day" value="1" min="1" max="31">
        <br><br>
        <button type="button" onclick="calculateCulmination()">Calcola Culminazione</button>
    </form>

    <h2>Ora di Culminazione della Luna</h2>
    <p id="result"></p>

    <script>
        function calculateCulmination() {
            const year = parseInt(document.getElementById("year").value);
            const month = parseInt(document.getElementById("month").value);
            const day = parseInt(document.getElementById("day").value);

            // Costanti per la posizione di Milano (latitudine e longitudine)
            const latitude = 45.45;
            const longitude = 9.19;

            // Funzione per calcolare il tempo siderale di Greenwich (GST)
            function getGST(year, month, day, hour, minute) {
                const JD = 367 * year - Math.floor((7 * (year + Math.floor((month + 9) / 12))) / 4) + Math.floor((275 * month) / 9) + day + 1721013.5;
                const T = (JD - 2451545.0) / 36525;
                const GST0 = 280.46061837 + 360.98564736629 * (JD - 2451545) + T * T * (0.000387933 - T / 38710000);
                return (GST0 % 360 + 360) % 360; // Ritorna il tempo siderale in gradi
            }

            // Calcolare il tempo siderale di Greenwich per la data (considerando 12:00 come orario base)
            const GST = getGST(year, month, day, 12, 0); // Time in GMT, es. 12:00 PM

            // Dati della Luna per il 1 Febbraio 2025 (approssimazione basata sulla posizione della Luna)
            const lunarRA = 23.5423; // Ascensione retta in gradi (approssimato per il 1 Febbraio 2025)
            const lunarDec = -10.115; // Declinazione in gradi (approssimato per il 1 Febbraio 2025)

            // Calcolare l'ora della culminazione
            const LST = GST + longitude / 15; // Tempo siderale locale
            const culminationTime = LST - lunarRA; // Differenza tra il LST e RA della Luna

            // Correggere se il valore di culminazione Ã¨ negativo
            if (culminationTime < 0) {
                culminationTime += 24; // Aggiungi 24 ore per ottenere il valore positivo
            }

            // Converti la culminazione in ore e minuti
            const hours = Math.floor(culminationTime);
            const minutes = Math.round((culminationTime - hours) * 60);

            // Converti in CET (GMT + 1 ora)
            const localHours = (hours + 1) % 24;

            // Mostra il risultato
            const resultText = `Ora di culminazione della Luna per ${day}/${month}/${year}: ${localHours}:${minutes < 10 ? '0' + minutes : minutes}`;
            document.getElementById("result").innerText = resultText;
        }
    </script>
</body>
</html>
